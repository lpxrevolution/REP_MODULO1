create database Evaluable2;
use Evaluable2;

Centro:
create table centro(
codigo_centro int,
ciudad varchar (25),
nombre varchar (30),
constraint centro_pk primary key (codigo_centro));

Bookiers:
create table bookiers(
dni varchar(9),
nombre varchar(15),
apellidos varchar(30),
id_centro int,
constraint bookiers_pk primary key (dni),
constraint bookiers_fk foreign key (id_centro) references centro(codigo_centro)
on delete cascade on update cascade);

Tarjetas:
create table tarjetas(
idtarjeta int,
dni_bookier varchar(9),
constraint tarejtas_pk primary key (idtarjeta),
constraint tarjetas_fk foreign key (dni_bookier) references bookiers(dni)
on delete cascade on update cascade);

BookierEstudiante:
create table bookierEstudiante(
dni_bookier varchar(9),
constraint bookierestudiante_pk primary key (dni_bookier)
on delete cascade, on update cascade),
constraint bookierestudiante_fk foreign key (dni_bookier) references bookiers(dni)
on delete cascade on update cascade);

Ventas:
create table ventas(
idventas int,
fecha date,
ip int,
constraint ventas_pk primary key (idventas));

EstuVentas:
create table estuventas(
idestuventas int,
idventas int,
dni_bookier varchar(9) not null,
constraint estuventas_pk primary key (idestuventas),
constraint estuventas_dni_fk foreign key (dni_bookier) references bookiers(dni)
on delete cascade, on update cascade,
constraint estuventas_idventa_fk foreign key (idventas) references ventas(idventas)
on delete set null on update cascade);

MatEstudiantes:
create table matestudiantes(
id_material_estu int,
constraint matestudiantas_pk primary key (id_material_estu));

LÃ­neas Estudiantes:
create table lineas_estudiantes(
n_linea int,
idestuventas int,
id_material_estu int not null,
cantidad int,
constraint lineas_estudiantas_pk primary key (n_linea, idestuventas),
constraint lineas_estud_ventas_fk foreign key (idestuventas) references estuventas(idestuventas)
on delete set null on update cascade,
constraint lineas_estud_material_fk foreign key (id_material_estu) references matestudiantes(id_material_estu)
on delete cascade on update cascade);

Materiales:
create table materiales(
id_material int,
precio float,
nombre varchar(15),
constraint materiales_pk primary key (id_material));

Recomienda:
create table recomienda_material(
id_material int,
id_material_recomendado int,
constraint material_recomendado_pk primary key (id_material, id_material_recomendado),
constraint material_fk foreign key (id_material) references materiales(id_material)
on delete cascade on update cascade,
constraint material_recomendado_fk foreign key (id_material_recomendado) references materiales(id_material)
on delete cascade on update cascade);

